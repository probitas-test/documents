{
  "name": "builder",
  "specifier": "@probitas/builder",
  "version": "0.4.2",
  "moduleDoc": "Builder module for creating scenario definitions with a fluent, type-safe API.\n\nThis package provides the {@linkcode scenario} fn function that returns a builder\nfor constructing scenario definitions. The builder uses method chaining to define\nresources, setup functions, and test steps with full TypeScript type inference.\n\n## Links\n\n- [GitHub Repository](https://github.com/probitas-test/probitas)\n- [@probitas/probitas](https://jsr.io/@probitas/probitas) - Main package (recommended for most users)\n\n## Related Packages\n\n| Package | Description |\n|---------|-------------|\n| [@probitas/core](https://jsr.io/@probitas/core) | Core type definitions used by this builder |\n| [@probitas/runner](https://jsr.io/@probitas/runner) | Executes scenarios built with this package |\n\n## Key Features\n\n- **Fluent API**: Chain methods naturally to build complex scenarios\n- **Type-safe context**: Each step receives typed access to previous step results\n- **Resource management**: Register resources with automatic lifecycle handling\n- **Setup/Cleanup**: Define setup functions with automatic cleanup support\n- **Configurable defaults**: Override timeout and retry settings at any level\n\n## Core Exports\n\n- {@linkcode scenario} - Factory function to create a new scenario builder\n- {@linkcode StepContext} - Type representing the context passed to step functions\n- {@linkcode StepFunction} - Type signature for step functions\n- {@linkcode SetupFunction} - Type signature for setup functions\n- {@linkcode ResourceFunction} - Type signature for resource fn functions\n- {@linkcode BuilderScenarioOptions} - Partial options for scenario configuration\n- {@linkcode BuilderStepOptions} - Partial options for step configuration\n- {@linkcode DEFAULT_SCENARIO_OPTIONS} - Default values for scenario options\n- {@linkcode DEFAULT_STEP_OPTIONS} - Default values for step options\n",
  "exports": [
    {
      "name": "scenario",
      "isDefault": false,
      "location": {
        "filename": "https://jsr.io/@probitas/builder/0.4.2/scenario_builder.ts",
        "line": 644,
        "col": 0,
        "byteIndex": 20517
      },
      "declarationKind": "export",
      "jsDoc": {
        "doc": "Create a new scenario builder with a fluent API.\n\nThis is the primary entry point for defining scenarios. It returns a builder\nthat provides a type-safe, chainable API for constructing test scenarios.\n",
        "tags": [
          {
            "kind": "param",
            "name": "name",
            "doc": "- Human-readable scenario name (shown in test reports)"
          },
          {
            "kind": "param",
            "name": "options",
            "doc": "- Optional configuration for tags, timeouts, and retry behavior"
          },
          {
            "kind": "return",
            "doc": "New {@linkcode ScenarioBuilderInit} instance ready for chaining\n"
          },
          {
            "kind": "unsupported",
            "value": "@remarks\nThe builder pattern enables:\n- **Type-safe chaining**: Return values flow through steps with full type inference\n- **Resource management**: Automatic lifecycle handling with Disposable support\n- **Flexible configuration**: Override defaults at scenario or step level\n"
          },
          {
            "kind": "example",
            "doc": "Basic scenario with type-safe step chaining\n```ts\nimport { scenario } from \"@probitas/builder\";\n\n// Mock user service for example\nconst createUser = (_data: { email: string }) =>\n  Promise.resolve({ id: \"user-123\" });\nconst verifyEmail = (_userId: string) => Promise.resolve();\n\nexport default scenario(\"User Registration\")\n  .step(\"Create user\", async () => {\n    const user = await createUser({ email: \"test@example.com\" });\n    return { userId: user.id };\n  })\n  .step(\"Verify email\", async (ctx) => {\n    // ctx.previous is typed as { userId: string }\n    await verifyEmail(ctx.previous.userId);\n  })\n  .build();\n```\n"
          },
          {
            "kind": "example",
            "doc": "Scenario with tags for filtering\n```ts\nimport { scenario } from \"@probitas/builder\";\n\nscenario(\"Payment Integration\", {\n  tags: [\"integration\", \"payment\", \"slow\"],\n  stepOptions: { timeout: 60000 }  // 1 minute timeout for all steps\n})\n  .step(\"Process payment\", async () => {\n    return { success: true };\n  })\n  .build();\n\n// Run with: probitas run -s \"tag:payment\"\n```\n"
          },
          {
            "kind": "example",
            "doc": "Scenario with resources and setup\n```ts\nimport { scenario } from \"@probitas/builder\";\n\n// Mock Database for example\nconst Database = {\n  connect: () =>\n    Promise.resolve({\n      rollback: () => {},\n      insert: (_data: { id: number }) => {},\n      query: (_sql: string) => [{ id: 1 }],\n    }),\n};\n\nscenario(\"Database Test\")\n  .resource(\"db\", async () => await Database.connect())\n  .setup((ctx) => {\n    // Run migrations\n    return () => ctx.resources.db.rollback();\n  })\n  .step(\"Insert data\", (ctx) => ctx.resources.db.insert({ id: 1 }))\n  .step(\"Query data\", (ctx) => ctx.resources.db.query(\"SELECT * FROM users\"))\n  .build();\n```\n"
          },
          {
            "kind": "see",
            "doc": "{@linkcode ScenarioBuilderInit} for available builder methods"
          },
          {
            "kind": "see",
            "doc": "{@linkcode BuilderScenarioOptions} for configuration options"
          }
        ]
      },
      "kind": "function",
      "functionDef": {
        "params": [
          {
            "kind": "identifier",
            "name": "name",
            "optional": false,
            "tsType": {
              "repr": "string",
              "kind": "keyword",
              "keyword": "string"
            }
          },
          {
            "kind": "identifier",
            "name": "options",
            "optional": true,
            "tsType": {
              "repr": "ScenarioOptions",
              "kind": "typeRef",
              "typeRef": {
                "typeParams": null,
                "typeName": "ScenarioOptions"
              }
            }
          }
        ],
        "returnType": {
          "repr": "ScenarioBuilderInit",
          "kind": "typeRef",
          "typeRef": {
            "typeParams": null,
            "typeName": "ScenarioBuilderInit"
          }
        },
        "hasBody": true,
        "isAsync": false,
        "isGenerator": false,
        "typeParams": []
      }
    },
    {
      "name": "BuilderStepContext",
      "isDefault": false,
      "location": {
        "filename": "https://jsr.io/@probitas/builder/0.4.2/types.ts",
        "line": 44,
        "col": 0,
        "byteIndex": 1337
      },
      "declarationKind": "export",
      "jsDoc": {
        "doc": "Execution context provided to steps, resources, and setup hooks.\n\nThe context provides access to:\n- Previous step results with full type inference\n- All accumulated results as a typed tuple\n- Named resources registered with `.resource()`\n- Shared storage for cross-step communication\n- Abort signal for timeout and cancellation handling\n",
        "tags": [
          {
            "kind": "template",
            "name": "P",
            "doc": "- Type of the previous step's return value"
          },
          {
            "kind": "template",
            "name": "A",
            "doc": "- Tuple type of all accumulated results from previous steps"
          },
          {
            "kind": "template",
            "name": "R",
            "doc": "- Record type mapping resource names to their types\n"
          },
          {
            "kind": "example",
            "doc": "Accessing previous result\n```ts\nimport { scenario } from \"@probitas/builder\";\n\nscenario(\"Chained Steps\")\n  .step(\"First\", () => ({ id: 123 }))\n  .step(\"Second\", (ctx) => {\n    console.log(ctx.previous.id);  // 123 (typed as number)\n  })\n  .build();\n```\n"
          },
          {
            "kind": "example",
            "doc": "Using shared store\n```ts\nimport { scenario } from \"@probitas/builder\";\n\nscenario(\"Store Example\")\n  .setup((ctx) => {\n    ctx.store.set(\"startTime\", Date.now());\n  })\n  .step(\"Check duration\", (ctx) => {\n    const start = ctx.store.get(\"startTime\") as number;\n    console.log(`Elapsed: ${Date.now() - start}ms`);\n  })\n  .build();\n```"
          }
        ]
      },
      "kind": "typeAlias",
      "typeAliasDef": {
        "tsType": {
          "repr": "",
          "kind": "intersection",
          "intersection": [
            {
              "repr": "StepContext",
              "kind": "typeRef",
              "typeRef": {
                "typeParams": null,
                "typeName": "StepContext"
              }
            },
            {
              "repr": "",
              "kind": "typeLiteral",
              "typeLiteral": {
                "constructors": [],
                "methods": [],
                "properties": [
                  {
                    "name": "previous",
                    "jsDoc": {
                      "doc": "Result from the previous step.\n\nFully typed based on what the previous step returned.\nFor the first step, this is `unknown`."
                    },
                    "location": {
                      "filename": "https://jsr.io/@probitas/builder/0.4.2/types.ts",
                      "line": 55,
                      "col": 2,
                      "byteIndex": 1678
                    },
                    "params": [],
                    "readonly": true,
                    "computed": false,
                    "optional": false,
                    "tsType": {
                      "repr": "P",
                      "kind": "typeRef",
                      "typeRef": {
                        "typeParams": null,
                        "typeName": "P"
                      }
                    },
                    "typeParams": []
                  },
                  {
                    "name": "results",
                    "jsDoc": {
                      "doc": "All accumulated results as a typed tuple.\n\nAllows accessing any previous result by index:\n- `ctx.results[0]` - First step's result\n- `ctx.results[1]` - Second step's result"
                    },
                    "location": {
                      "filename": "https://jsr.io/@probitas/builder/0.4.2/types.ts",
                      "line": 64,
                      "col": 2,
                      "byteIndex": 1912
                    },
                    "params": [],
                    "readonly": true,
                    "computed": false,
                    "optional": false,
                    "tsType": {
                      "repr": "A",
                      "kind": "typeRef",
                      "typeRef": {
                        "typeParams": null,
                        "typeName": "A"
                      }
                    },
                    "typeParams": []
                  },
                  {
                    "name": "resources",
                    "jsDoc": {
                      "doc": "Named resources registered with `.resource()`.\n\nResources are typed based on their registration:\n```ts\nimport { scenario } from \"@probitas/builder\";\n\n// Mock database connection for example\nconst createDbConnection = () => ({ query: (_sql: string) => [{ id: 1 }] });\n\nscenario(\"test\")\n  .resource(\"db\", () => createDbConnection())\n  .step((ctx) => ctx.resources.db.query(\"SELECT 1\"))\n  .build();\n```"
                    },
                    "location": {
                      "filename": "https://jsr.io/@probitas/builder/0.4.2/types.ts",
                      "line": 82,
                      "col": 2,
                      "byteIndex": 2415
                    },
                    "params": [],
                    "readonly": true,
                    "computed": false,
                    "optional": false,
                    "tsType": {
                      "repr": "R",
                      "kind": "typeRef",
                      "typeRef": {
                        "typeParams": null,
                        "typeName": "R"
                      }
                    },
                    "typeParams": []
                  }
                ],
                "callSignatures": [],
                "indexSignatures": []
              }
            }
          ]
        },
        "typeParams": [
          {
            "name": "P",
            "default": {
              "repr": "unknown",
              "kind": "keyword",
              "keyword": "unknown"
            }
          },
          {
            "name": "A",
            "constraint": {
              "repr": "",
              "kind": "typeOperator",
              "typeOperator": {
                "operator": "readonly",
                "tsType": {
                  "repr": "",
                  "kind": "array",
                  "array": {
                    "repr": "unknown",
                    "kind": "keyword",
                    "keyword": "unknown"
                  }
                }
              }
            },
            "default": {
              "repr": "",
              "kind": "typeOperator",
              "typeOperator": {
                "operator": "readonly",
                "tsType": {
                  "repr": "",
                  "kind": "array",
                  "array": {
                    "repr": "unknown",
                    "kind": "keyword",
                    "keyword": "unknown"
                  }
                }
              }
            }
          },
          {
            "name": "R",
            "constraint": {
              "repr": "Record",
              "kind": "typeRef",
              "typeRef": {
                "typeParams": [
                  {
                    "repr": "string",
                    "kind": "keyword",
                    "keyword": "string"
                  },
                  {
                    "repr": "unknown",
                    "kind": "keyword",
                    "keyword": "unknown"
                  }
                ],
                "typeName": "Record"
              }
            },
            "default": {
              "repr": "Record",
              "kind": "typeRef",
              "typeRef": {
                "typeParams": [
                  {
                    "repr": "string",
                    "kind": "keyword",
                    "keyword": "string"
                  },
                  {
                    "repr": "unknown",
                    "kind": "keyword",
                    "keyword": "unknown"
                  }
                ],
                "typeName": "Record"
              }
            }
          }
        ]
      }
    },
    {
      "name": "BuilderStepFunction",
      "isDefault": false,
      "location": {
        "filename": "https://jsr.io/@probitas/builder/0.4.2/types.ts",
        "line": 117,
        "col": 0,
        "byteIndex": 3428
      },
      "declarationKind": "export",
      "jsDoc": {
        "doc": "Function signature for step execution.\n\nA step function receives the execution context and returns a value\n(sync or async) that becomes available to subsequent steps.\n",
        "tags": [
          {
            "kind": "template",
            "name": "T",
            "doc": "- Type of this step's return value"
          },
          {
            "kind": "template",
            "name": "P",
            "doc": "- Type of the previous step's result (from `ctx.previous`)"
          },
          {
            "kind": "template",
            "name": "A",
            "doc": "- Tuple type of all accumulated results"
          },
          {
            "kind": "template",
            "name": "R",
            "doc": "- Record of available resources\n"
          },
          {
            "kind": "example",
            "doc": "Sync step returning data\n```ts\nimport type { BuilderStepFunction } from \"@probitas/builder\";\n\nconst step: BuilderStepFunction<{ name: string }> = (_ctx) => {\n  return { name: \"Alice\" };\n};\n```\n"
          },
          {
            "kind": "example",
            "doc": "Async step with API call\n```ts\nimport type { BuilderStepFunction } from \"@probitas/builder\";\n\ntype User = { id: string; name: string };\n\nconst step: BuilderStepFunction<User> = async (ctx) => {\n  const response = await fetch(\"/api/user\", { signal: ctx.signal });\n  return response.json();\n};\n```"
          }
        ]
      },
      "kind": "typeAlias",
      "typeAliasDef": {
        "tsType": {
          "repr": "",
          "kind": "fnOrConstructor",
          "fnOrConstructor": {
            "constructor": false,
            "tsType": {
              "repr": "",
              "kind": "union",
              "union": [
                {
                  "repr": "T",
                  "kind": "typeRef",
                  "typeRef": {
                    "typeParams": null,
                    "typeName": "T"
                  }
                },
                {
                  "repr": "Promise",
                  "kind": "typeRef",
                  "typeRef": {
                    "typeParams": [
                      {
                        "repr": "T",
                        "kind": "typeRef",
                        "typeRef": {
                          "typeParams": null,
                          "typeName": "T"
                        }
                      }
                    ],
                    "typeName": "Promise"
                  }
                }
              ]
            },
            "params": [
              {
                "kind": "identifier",
                "name": "ctx",
                "optional": false,
                "tsType": {
                  "repr": "BuilderStepContext",
                  "kind": "typeRef",
                  "typeRef": {
                    "typeParams": [
                      {
                        "repr": "P",
                        "kind": "typeRef",
                        "typeRef": {
                          "typeParams": null,
                          "typeName": "P"
                        }
                      },
                      {
                        "repr": "A",
                        "kind": "typeRef",
                        "typeRef": {
                          "typeParams": null,
                          "typeName": "A"
                        }
                      },
                      {
                        "repr": "R",
                        "kind": "typeRef",
                        "typeRef": {
                          "typeParams": null,
                          "typeName": "R"
                        }
                      }
                    ],
                    "typeName": "BuilderStepContext"
                  }
                }
              }
            ],
            "typeParams": []
          }
        },
        "typeParams": [
          {
            "name": "T",
            "default": {
              "repr": "unknown",
              "kind": "keyword",
              "keyword": "unknown"
            }
          },
          {
            "name": "P",
            "default": {
              "repr": "unknown",
              "kind": "keyword",
              "keyword": "unknown"
            }
          },
          {
            "name": "A",
            "constraint": {
              "repr": "",
              "kind": "typeOperator",
              "typeOperator": {
                "operator": "readonly",
                "tsType": {
                  "repr": "",
                  "kind": "array",
                  "array": {
                    "repr": "unknown",
                    "kind": "keyword",
                    "keyword": "unknown"
                  }
                }
              }
            },
            "default": {
              "repr": "",
              "kind": "typeOperator",
              "typeOperator": {
                "operator": "readonly",
                "tsType": {
                  "repr": "",
                  "kind": "array",
                  "array": {
                    "repr": "unknown",
                    "kind": "keyword",
                    "keyword": "unknown"
                  }
                }
              }
            }
          },
          {
            "name": "R",
            "constraint": {
              "repr": "Record",
              "kind": "typeRef",
              "typeRef": {
                "typeParams": [
                  {
                    "repr": "string",
                    "kind": "keyword",
                    "keyword": "string"
                  },
                  {
                    "repr": "unknown",
                    "kind": "keyword",
                    "keyword": "unknown"
                  }
                ],
                "typeName": "Record"
              }
            },
            "default": {
              "repr": "Record",
              "kind": "typeRef",
              "typeRef": {
                "typeParams": [
                  {
                    "repr": "string",
                    "kind": "keyword",
                    "keyword": "string"
                  },
                  {
                    "repr": "unknown",
                    "kind": "keyword",
                    "keyword": "unknown"
                  }
                ],
                "typeName": "Record"
              }
            }
          }
        ]
      }
    },
    {
      "name": "BuilderStepDefinition",
      "isDefault": false,
      "location": {
        "filename": "https://jsr.io/@probitas/builder/0.4.2/types.ts",
        "line": 139,
        "col": 0,
        "byteIndex": 4203
      },
      "declarationKind": "export",
      "jsDoc": {
        "doc": "Immutable definition of a scenario step.\n\nContains all information needed to execute a single step:\nthe step function, its options, and debugging metadata.\n",
        "tags": [
          {
            "kind": "template",
            "name": "T",
            "doc": "- Type of this step's return value"
          },
          {
            "kind": "template",
            "name": "P",
            "doc": "- Type of the previous step's result"
          },
          {
            "kind": "template",
            "name": "A",
            "doc": "- Tuple type of accumulated results"
          },
          {
            "kind": "template",
            "name": "R",
            "doc": "- Record of available resources\n"
          },
          {
            "kind": "unsupported",
            "value": "@remarks\nStep definitions are created by the builder and consumed by the runner.\nThey are immutable and should not be modified after creation."
          }
        ]
      },
      "kind": "typeAlias",
      "typeAliasDef": {
        "tsType": {
          "repr": "",
          "kind": "intersection",
          "intersection": [
            {
              "repr": "StepDefinition",
              "kind": "typeRef",
              "typeRef": {
                "typeParams": null,
                "typeName": "StepDefinition"
              }
            },
            {
              "repr": "",
              "kind": "typeLiteral",
              "typeLiteral": {
                "constructors": [],
                "methods": [],
                "properties": [
                  {
                    "name": "fn",
                    "jsDoc": {
                      "doc": "Step function to execute"
                    },
                    "location": {
                      "filename": "https://jsr.io/@probitas/builder/0.4.2/types.ts",
                      "line": 146,
                      "col": 2,
                      "byteIndex": 4443
                    },
                    "params": [],
                    "readonly": true,
                    "computed": false,
                    "optional": false,
                    "tsType": {
                      "repr": "BuilderStepFunction",
                      "kind": "typeRef",
                      "typeRef": {
                        "typeParams": [
                          {
                            "repr": "T",
                            "kind": "typeRef",
                            "typeRef": {
                              "typeParams": null,
                              "typeName": "T"
                            }
                          },
                          {
                            "repr": "P",
                            "kind": "typeRef",
                            "typeRef": {
                              "typeParams": null,
                              "typeName": "P"
                            }
                          },
                          {
                            "repr": "A",
                            "kind": "typeRef",
                            "typeRef": {
                              "typeParams": null,
                              "typeName": "A"
                            }
                          },
                          {
                            "repr": "R",
                            "kind": "typeRef",
                            "typeRef": {
                              "typeParams": null,
                              "typeName": "R"
                            }
                          }
                        ],
                        "typeName": "BuilderStepFunction"
                      }
                    },
                    "typeParams": []
                  }
                ],
                "callSignatures": [],
                "indexSignatures": []
              }
            }
          ]
        },
        "typeParams": [
          {
            "name": "T",
            "default": {
              "repr": "unknown",
              "kind": "keyword",
              "keyword": "unknown"
            }
          },
          {
            "name": "P",
            "default": {
              "repr": "unknown",
              "kind": "keyword",
              "keyword": "unknown"
            }
          },
          {
            "name": "A",
            "constraint": {
              "repr": "",
              "kind": "typeOperator",
              "typeOperator": {
                "operator": "readonly",
                "tsType": {
                  "repr": "",
                  "kind": "array",
                  "array": {
                    "repr": "unknown",
                    "kind": "keyword",
                    "keyword": "unknown"
                  }
                }
              }
            },
            "default": {
              "repr": "",
              "kind": "typeOperator",
              "typeOperator": {
                "operator": "readonly",
                "tsType": {
                  "repr": "",
                  "kind": "array",
                  "array": {
                    "repr": "unknown",
                    "kind": "keyword",
                    "keyword": "unknown"
                  }
                }
              }
            }
          },
          {
            "name": "R",
            "constraint": {
              "repr": "Record",
              "kind": "typeRef",
              "typeRef": {
                "typeParams": [
                  {
                    "repr": "string",
                    "kind": "keyword",
                    "keyword": "string"
                  },
                  {
                    "repr": "unknown",
                    "kind": "keyword",
                    "keyword": "unknown"
                  }
                ],
                "typeName": "Record"
              }
            },
            "default": {
              "repr": "Record",
              "kind": "typeRef",
              "typeRef": {
                "typeParams": [
                  {
                    "repr": "string",
                    "kind": "keyword",
                    "keyword": "string"
                  },
                  {
                    "repr": "unknown",
                    "kind": "keyword",
                    "keyword": "unknown"
                  }
                ],
                "typeName": "Record"
              }
            }
          }
        ]
      }
    }
  ]
}
